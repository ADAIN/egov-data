<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset='utf-8' />
		<meta http-equiv="X-UA-Compatible" content="chrome=1" />
		<meta name="description" content="eGov-Data : 표준프레임워크와 Spring Data의 만남" />
		<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
		<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/prettify.css">
		<script type="text/javascript" src="javascripts/prettify.js"></script>
		<title>eGov-Data-iBatis Page</title>
	</head>
	
	<body onload="prettyPrint()">
		<!-- HEADER -->
		<div id="header_wrap" class="outer">
			<header class="inner">
				<a id="forkme_banner" href="https://github.com/spring-sprout/egov-data">Fork Me on GitHub</a>
				<h1 id="project_title">eGov-Data-iBatis</h1>
				<h2 id="project_tagline">표준프레임워크 eGov-Data-iBatis 가이드</h2>
				<section id="downloads">
					<a class="zip_download_link"
						href="https://github.com/spring-sprout/egov-data/zipball/master">Download
						this project as a .zip file</a> <a class="tar_download_link"
						href="https://github.com/spring-sprout/egov-data/tarball/master">Download
						this project as a tar.gz file</a>
				</section>
			</header>
		</div>

		<!-- MAIN CONTENT -->
		<div id="main_content_wrap" class="outer">
			<section id="main_content" class="inner">
				<h3>eGov-Data-iBatis Quick Start</h3>
				
				<h4>Setup</h4>
				<ol>
					<li>
						프로젝트 다운로드<br/>
						<pre class="prettyprint">git clone https://github.com/spring-sprout/egov-data.git</pre>
					</li>
					<li>
						Maven을 사용해 jar 생성<br/>
						<pre class="prettyprint">mvn jar:jar</pre>
					</li>
					<li><pre class="prettyprint">classpath에 target/egov-data-ibatis.[version].jar 추가</pre></li>
				</ol>
				
				<h4>Entity</h4>
				<code class="prettyprint">
					public class SpringSprout {
						private Long id;
						private String name;
						
						// Getters and setters
					}
				</code>
				
				<h4>Repository</h4>
				<code class="prettyprint">
					public interface SpringSproutRepository extends SqlMapRepository&#60SpringSprout, Long&#62 {
	
						public List&#60SpringSprout&#62 findAll();
						
						public SpringSprout findByName(String name);
						
						public SpringSprout insert(SpringSprout springSprout);
						
						public int update(SpringSprout springSprout);
						
						public int delete(Long id);
						
						// ..기타 다른 메소드
					}
				</code>
				
				<h4>SqlMap.xml</h4>
				<code class="prettyprint">
					&#60?xml version="1.0" encoding="UTF-8"?&#62
					&#60!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
						"http://ibatis.apache.org/dtd/sql-map-2.dtd"&#62
					&#60sqlMap namespace="SpringSprout"&#62
					
					    &#60typeAlias alias="SpringSprout" type="egov.data.ibatis.sample.domain.SpringSprout"/&#62
					
						&#60select id="findAll" resultClass="SpringSprout"&#62
							SELECT * FROM SPRINGSPROUT
					    &#60/select&#62    
					    &#60select id="findByName" parameterClass="string" resultClass="SpringSprout"&#62
							SELECT * FROM SPRINGSPROUT WHERE NAME = #name#
					    &#60/select&#62
					    &#60select id="findOne" parameterClass="long" resultClass="SpringSprout"&#62
							SELECT * FROM SPRINGSPROUT WHERE ID = #id#
					    &#60/select&#62
					    &#60insert id="insert" parameterClass="SpringSprout"&#62
					        INSERT INTO SPRINGSPROUT(NAME) VALUES(#name#);
					        &#60selectKey resultClass="long" keyProperty="id"&#62
					            CALL IDENTITY()
					        &#60/selectKey&#62
					    &#60/insert&#62
					    &#60update id="update" parameterClass="SpringSprout"&#62
							UPDATE SPRINGSPROUT SET NAME = #name# WHERE ID = #id# 
					    &#60/update&#62
					    
					&#60/sqlMap&#62
				</code>
				
				<h4>applicationContext.xml</h4>
				<code class="prettyprint">
					&#60?xml version="1.0" encoding="UTF-8"?&#62
					&#60beans xmlns="http://www.springframework.org/schema/beans"
						xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
						xmlns:jdbc="http://www.springframework.org/schema/jdbc"
						xmlns:tx="http://www.springframework.org/schema/tx"
						xsi:schemaLocation="http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
							http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
							http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
							http://www.egovframe.org/schema/data/ibatis http://www.egovframe.org/schema/data/ibatis/egov-ibatis.xsd"&#62
						
						&#60jdbc:embedded-database id="dataSource" type="H2"&#62
					    	&#60jdbc:script location="classpath:sqlScript/schema.sql"/&#62
					    &#60/jdbc:embedded-database&#62
					    
					    &#60bean id="sqlMapClient" class="org.springframework.orm.ibatis.SqlMapClientFactoryBean"&#62
					        &#60property name="dataSource" ref="dataSource" /&#62
					        &#60property name="configLocation" value="classpath:ibatis/sqlMapConfig.xml" /&#62
					        &#60property name="mappingLocations" value="classpath:ibatis/sqlmap/*.xml" /&#62
					    &#60/bean&#62
					    
					    &#60ibatis:repositories base-package="egov.data.ibatis.sample.repository"/&#62
						
					&#60/beans&#60		
				</code>
				
				<h4>Test</h4>
				<code class="prettyprint">
					@RunWith(SpringJUnit4ClassRunner.class)
					@ContextConfiguration
					public class SpringSproutRepositoryTest {
					
						@Autowired SpringSproutRepository repository;
	
						SpringSprout first, second, third;
						
						@Before
						public void setup() {
							first = new SpringSprout("miracle");
							second = new SpringSprout("daclouds");
							third = new SpringSprout("yunseok");
						}
						
						@Test
						public void testInsert() {
							int before = count();
							
							repository.insert(first);
							repository.insert(second);
							repository.insert(third);
							
							assertThat(count(), is(before + 3));
						}
						
						// ..기타 테스트 메소드
					}
				</code>
				
			</section>
		</div>

		<!-- FOOTER  -->
		<div id="footer_wrap" class="outer">
			<footer class="inner">
				<p class="copyright">
					eGov-Data maintained by <a href="https://github.com/spring-sprout">spring-sprout</a>
				</p>
				<p>
					Published with <a href="http://pages.github.com">GitHub Pages</a>
				</p>
			</footer>
		</div>
	</body>
</html>